---
// Chat demo component
---

<div class="device" aria-label="Backend orchestration preview">
  <div class="stitches"></div>
  <div class="device-head">
    <span class="patch-badge">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none">
        <path d="M12 3l2.6 5.3L20 9l-4 3.9L17 19l-5-2.7L7 19l1-6.1L4 9l5.4-.7L12 3z" stroke="currentColor" opacity=".9" stroke-width="1.3" fill="none"/>
      </svg>
      Multi-Agent Orchestration
    </span>
    <span class="pill">Live • Production</span>
  </div>
  <div class="chat" id="chatbox">
    <div class="msg ai">Your custom UI is connected. I'm coordinating 3 specialized agents for your workflow.</div>
    <div class="msg user">Process this customer inquiry with sentiment analysis and response generation.</div>
    <div class="msg ai">Agent 1: Analyzing sentiment... Positive (0.92 confidence)</div>
    <div class="msg ai">Agent 2: Extracting intent... Product inquiry detected</div>
    <div class="msg ai">Agent 3: Generating response with context from your knowledge base...</div>
    <div class="msg ai success">✓ Pipeline complete. Response drafted and ready for your UI.</div>
  </div>
  <div class="composer">
    <div class="input">
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true">
        <path d="M4 12h16M4 6h10M4 18h10" stroke="currentColor" opacity=".6" stroke-width="1.6" stroke-linecap="round"/>
      </svg>
      <input id="prompt" type="text" placeholder="Configure your agent pipeline..." aria-label="Message"/>
    </div>
    <button class="send" id="sendBtn">Execute</button>
  </div>
</div>

<style>
  .device {
    position: relative;
    border-radius: 22px;
    background: var(--card);
    border: 1px solid var(--border);
    box-shadow: var(--shadow);
    overflow: hidden;
    transform: rotate(-1deg);
    transition: transform .25s ease;
  }

  .device:hover {
    transform: rotate(0deg);
  }

  .device-head {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 14px 16px;
    background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,0));
    border-bottom: 1px dashed rgba(255,255,255,.12);
  }

  .patch-badge {
    display: inline-flex;
    gap: 8px;
    align-items: center;
    font-size: .85rem;
    color: var(--patch-ink);
    padding: 6px 10px;
    border-radius: 10px;
    background: repeating-linear-gradient(135deg, rgba(122,255,198,.08) 0 8px, rgba(90,209,255,.08) 8px 16px);
    border: 1px dashed rgba(255,255,255,.25);
    position: relative;
  }

  .patch-badge::after {
    content: "";
    position: absolute;
    inset: 2px;
    border: 1px dashed rgba(0,0,0,.25);
    border-radius: 8px;
    opacity: .3;
    mix-blend-mode: overlay;
  }

  .pill {
    display: inline-flex;
    gap: 8px;
    align-items: center;
    background: var(--glass-2);
    border: 1px dashed rgba(255,255,255,.15);
    padding: 6px 10px;
    border-radius: 999px;
    color: var(--muted);
    font-size: .85rem;
  }

  .stitches {
    position: absolute;
    inset: 0;
    pointer-events: none;
    opacity: .6;
    background:
      linear-gradient(transparent 49%, rgba(255,255,255,.07) 50%, transparent 51%) 0 0/100% 40px,
      linear-gradient(90deg, transparent 49%, rgba(255,255,255,.07) 50%, transparent 51%) 0 0/40px 100%;
    mask-image: linear-gradient(180deg, rgba(0,0,0,1), rgba(0,0,0,.7) 80%, transparent);
  }

  .chat {
    max-height: 460px;
    overflow: auto;
    padding: 16px;
    display: grid;
    gap: 10px;
    background:
      linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,0)),
      repeating-linear-gradient(0deg, rgba(255,255,255,.02) 0 2px, transparent 2px 4px);
  }

  .msg {
    max-width: 86%;
    padding: 12px 14px;
    border-radius: 14px;
    font-size: .98rem;
    background: var(--glass);
    border: 1px dashed rgba(255,255,255,.18);
    backdrop-filter: blur(6px);
  }

  .msg.ai {
    background: linear-gradient(180deg, rgba(90,209,255,.18), rgba(122,255,198,.12));
    border: 1px dashed rgba(122,255,198,.35);
  }

  .msg.ai.success {
    background: linear-gradient(180deg, rgba(70,232,162,.18), rgba(122,255,198,.12));
    border: 1px dashed rgba(70,232,162,.35);
  }

  .msg.user {
    margin-left: auto;
    background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
  }

  .composer {
    padding: 12px;
    border-top: 1px dashed rgba(255,255,255,.16);
    background: linear-gradient(180deg, rgba(0,0,0,.15), rgba(255,255,255,0));
    display: flex;
    gap: 10px;
    align-items: center;
  }

  .input {
    flex: 1;
    display: flex;
    align-items: center;
    gap: 8px;
    background: rgba(255,255,255,.04);
    padding: 10px 12px;
    border-radius: 12px;
    border: 1px solid rgba(255,255,255,.16);
  }

  .input input {
    width: 100%;
    background: transparent;
    border: none;
    outline: none;
    color: var(--ink);
    font-size: .98rem;
    font-family: inherit;
  }

  .send {
    padding: 10px 14px;
    border-radius: 12px;
    background: linear-gradient(135deg, rgba(122,255,198,.28), rgba(90,209,255,.24));
    border: 1px solid rgba(122,255,198,.45);
    color: #062014;
    font-weight: 800;
    cursor: pointer;
    transition: transform .12s ease, filter .2s ease;
    border: none;
    font-family: inherit;
  }

  .send:hover {
    transform: translateY(-1px);
    filter: saturate(1.1);
  }
</style>

<script>
  const sendBtn = document.getElementById('sendBtn') as HTMLButtonElement;
  const chat = document.getElementById('chatbox') as HTMLDivElement;
  const promptInput = document.getElementById('prompt') as HTMLInputElement;

  function addMsg(text: string, role: 'ai' | 'user' = 'ai') {
    const el = document.createElement('div');
    el.className = `msg ${role}`;
    el.textContent = text;
    chat.appendChild(el);
    chat.scrollTop = chat.scrollHeight;
  }

  sendBtn?.addEventListener('click', () => {
    const text = promptInput.value.trim();
    if (!text) return;
    addMsg(text, 'user');
    promptInput.value = '';

    setTimeout(() => {
      const responses = [
        "Initializing agent pipeline with your configuration...",
        "Orchestrating multiple agents for parallel processing...",
        "Applying error recovery and retry logic...",
        "Scaling microservices to handle increased load...",
        "Event stream established. Real-time updates enabled."
      ];
      const reply = responses[Math.floor(Math.random() * responses.length)];
      addMsg(reply, 'ai');
    }, 500);
  });

  promptInput?.addEventListener('keydown', (e: KeyboardEvent) => {
    if (e.key === 'Enter') sendBtn?.click();
  });
</script>