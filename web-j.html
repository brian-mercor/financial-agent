<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <meta name="theme-color" content="#0b0b0c" />
  <title>iChatbook — The End of Passive Reading</title>
  <meta name="description" content="iChatbook: From passive reading to active dialogue. Engage, question, and challenge every idea with a Socratic, intellectually rigorous reading experience." />
  <meta property="og:title" content="iChatbook — The End of Passive Reading" />
  <meta property="og:description" content="Engage, question, and challenge every idea. Active reading for critical thinkers, debaters, and intellectuals." />
  <meta property="og:type" content="website" />
  <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@500;600&family=Inter:wght@300;400;500;600&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#0a0b0c;
      --ink:#0b0c0d;
      --paper:#0f1012;
      --line:#131417;
      --gold:#d2b26d;
      --gold-2:#b59657;
      --gold-dim:#8a7444;
      --text:#ececec;
      --muted:rgba(255,255,255,.68);
      --dim:rgba(255,255,255,.40);
      --ink-veil:rgba(255,255,255,0.04);
      --shadow:0 20px 50px rgba(0,0,0,.55);
      --radius:16px;
      --radius-sm:12px;
      --radius-xs:10px;
      --grad-ink:radial-gradient(1200px 600px at 20% 10%, rgba(255,255,255,.06), transparent 60%),
                  radial-gradient(800px 400px at 80% 80%, rgba(255,255,255,.04), transparent 60%);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    html{color-scheme:dark}
    body{
      margin:0;
      font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
      color:var(--text);
      background:linear-gradient(180deg, #08090a 0%, #0a0b0c 40%, #0b0c0e 100%);
      background-attachment:fixed;
      letter-spacing:.01em;
      line-height:1.6;
    }
    a{color:var(--gold);text-decoration:none}
    a:hover{color:#e3c883}
    .container{max-width:1200px;margin-inline:auto;padding-inline:24px}
    header{
      position:sticky;top:0;z-index:40;
      backdrop-filter:saturate(120%) blur(10px);
      background:linear-gradient(to bottom, rgba(10,11,12,.7), rgba(10,11,12,.45));
      border-bottom:1px solid rgba(255,255,255,.06);
    }
    .nav{
      display:flex;align-items:center;justify-content:space-between;gap:16px;
      padding:14px 0;
    }
    .brand{
      display:flex;align-items:center;gap:12px;color:var(--text);font-weight:600;letter-spacing:.02em;
    }
    .brand-mark{
      width:28px;height:28px;border-radius:50%;
      display:grid;place-items:center;
      background:
        radial-gradient(100% 100% at 25% 30%, rgba(210,178,109,.35), transparent 40%),
        linear-gradient(145deg, #131518, #0c0d0f);
      border:1px solid rgba(255,255,255,.08);
      box-shadow:inset 0 0 12px rgba(255,255,255,.06), 0 6px 20px rgba(0,0,0,.35);
    }
    .brand svg{width:18px;height:18px;opacity:.95}
    .nav-links{display:flex;gap:18px;align-items:center}
    .nav-links a{color:var(--muted);font-size:.95rem}
    .nav-cta{
      padding:10px 14px;border-radius:999px;
      background:linear-gradient(180deg, #d2b26d, #b2914d);
      color:#0b0b0c;font-weight:600;box-shadow:0 10px 22px rgba(210,178,109,.18), inset 0 1px 0 rgba(255,255,255,.4);
      border:0;cursor:pointer;transition:transform .15s ease, filter .2s ease; text-decoration:none;
    }
    .nav-cta:hover{transform:translateY(-1px);filter:brightness(1.06)}
    .nav-cta:active{transform:translateY(0)}
    /* Hero */
    .hero{
      position:relative;isolation:isolate;overflow:hidden;
      min-height:88vh;display:grid;place-items:center;
      background:
        radial-gradient(1200px 700px at 10% 20%, rgba(210,178,109,.10), transparent 70%),
        var(--grad-ink), linear-gradient(180deg, #0a0b0c 0%, #0a0b0c 100%);
      border-bottom:1px solid rgba(255,255,255,.06);
    }
    .ink-canvas{position:absolute;inset:0;z-index:0;opacity:.65;mix-blend-mode:overlay;pointer-events:none}
    .hero-grid-lines::before,
    .hero-grid-lines::after{
      content:"";
      position:absolute;inset:0;z-index:1;pointer-events:none;
      background-image:
        linear-gradient(to right, rgba(255,255,255,.03) 1px, transparent 1px),
        linear-gradient(to bottom, rgba(255,255,255,.03) 1px, transparent 1px);
      background-size:80px 80px;
      mask-image:radial-gradient(70% 60% at 50% 40%, rgba(0,0,0,1), rgba(0,0,0,0));
    }
    .hero-inner{position:relative;z-index:3;padding:80px 0 60px}
    .eyebrow{
      display:inline-flex;align-items:center;gap:10px;
      background:rgba(210,178,109,.08);border:1px solid rgba(210,178,109,.25);
      color:#e8d7a1;padding:8px 12px;border-radius:999px;font-size:.85rem;letter-spacing:.08em;text-transform:uppercase;
      box-shadow:inset 0 0 14px rgba(210,178,109,.12);
    }
    .hero-title{
      font-family:"Cormorant Garamond",serif;
      font-weight:600;line-height:1.1;letter-spacing:.01em;
      font-size:clamp(2rem, 4.2vw + .8rem, 4.1rem);
      margin:18px 0 14px;
      text-wrap:balance;
      text-shadow:0 10px 40px rgba(0,0,0,.45);
    }
    .hero-sub{
      color:var(--muted);max-width:790px;font-size:clamp(1rem, 1.1vw + .8rem, 1.25rem)
    }
    .hero-actions{display:flex;flex-wrap:wrap;gap:14px;margin-top:26px}
    .btn{
      display:inline-flex;align-items:center;gap:10px;cursor:pointer;border:0;text-decoration:none;
      padding:14px 18px;border-radius:14px;font-weight:600;transition:transform .15s ease, filter .2s ease, box-shadow .2s ease;
      box-shadow:var(--shadow);
    }
    .btn-primary{
      background:linear-gradient(180deg, #d2b26d, #b2914d);
      color:#101113;box-shadow:0 18px 40px rgba(210,178,109,.20), inset 0 1px 0 rgba(255,255,255,.55)
    }
    .btn-primary:hover{transform:translateY(-1px);filter:brightness(1.06)}
    .btn-ghost{
      background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.10);color:var(--text)
    }
    .btn-ghost:hover{transform:translateY(-1px);background:rgba(255,255,255,.08)}
    /* Brush SVG */
    .brush{
      position:absolute;inset:auto auto 5% -5%;width:min(1200px, 130%);height:auto;z-index:2;opacity:.16;
      filter:contrast(110%) brightness(95%);
      transform:rotate(-2deg);
    }
    .ticker-wrap{
      position:absolute;inset:auto 0 0 0;z-index:4;pointer-events:none;
      display:grid;gap:6px;padding-bottom:10px;
    }
    .ticker-line{
      position:relative;overflow:hidden;height:28px;opacity:.75;
      mask-image:linear-gradient(to right, transparent 0, black 10%, black 90%, transparent 100%);
    }
    .ticker{
      position:absolute;white-space:nowrap;will-change:transform;
      animation:scroll-x 28s linear infinite;
      font-family:"Space Mono",ui-monospace,monospace;
      font-size:.92rem;letter-spacing:.04em;
      color:#d8c38a; text-shadow:0 0 6px rgba(210,178,109,.18);
    }
    .ticker:nth-child(2){animation-duration:36s;opacity:.85}
    .ticker:nth-child(3){animation-duration:42s;opacity:.55}
    .ticker .item{
      display:inline-flex;gap:8px;align-items:center;margin-right:36px;padding:4px 10px;border-radius:10px;
      background:rgba(210,178,109,.06);border:1px solid rgba(210,178,109,.16)
    }
    .ticker .up{color:#a7e685}
    .ticker .down{color:#ff9c9c}
    .ticker .sep{color:rgba(255,255,255,.3)}
    @keyframes scroll-x{
      0%{transform:translateX(0)}
      100%{transform:translateX(-50%)}
    }
    /* Sections */
    section{padding:72px 0}
    .section-title{
      font-family:"Cormorant Garamond",serif;font-weight:600;
      font-size:clamp(1.6rem, 1.6vw + 1rem, 2.2rem); margin:0 0 12px;
    }
    .section-sub{color:var(--muted);margin:0 0 28px;max-width:840px}
    .cards{
      display:grid;gap:18px;grid-template-columns:repeat(12,1fr)
    }
    .card{
      grid-column:span 4;
      background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      border:1px solid rgba(255,255,255,.09);border-radius:var(--radius);padding:22px;
      box-shadow:var(--shadow);
      transition:transform .2s ease, background .2s ease, border-color .2s ease
    }
    .card:hover{transform:translateY(-2px);background:linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.04));border-color:rgba(255,255,255,.14)}
    .card h3{margin:0 0 8px;font-family:"Cormorant Garamond",serif;font-weight:600}
    .card p{margin:0;color:var(--muted)}
    /* Socratic Engine */
    .engine{
      display:grid;grid-template-columns:repeat(12,1fr);gap:18px;align-items:start
    }
    .panel{
      grid-column:span 6;background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      border:1px solid rgba(255,255,255,.09);border-radius:var(--radius);padding:18px;box-shadow:var(--shadow);
    }
    .panel h4{margin:6px 0 12px;font-family:"Cormorant Garamond",serif}
    .textarea{
      width:100%;min-height:150px;background:rgba(0,0,0,.3);
      border:1px solid rgba(255,255,255,.1);border-radius:14px;padding:14px 14px 42px 14px;color:var(--text);
      resize:vertical;font-family:Inter,system-ui,sans-serif;font-size:1rem;line-height:1.6; outline:none;
      box-shadow:inset 0 0 0 1px rgba(255,255,255,.03);
    }
    .control-row{display:flex;flex-wrap:wrap;gap:12px;align-items:center;margin-top:10px}
    .chip{
      display:inline-flex;gap:8px;align-items:center;padding:8px 12px;border-radius:999px;font-weight:600;font-size:.92rem;cursor:pointer;
      background:rgba(255,255,255,.07);border:1px solid rgba(255,255,255,.1);color:var(--text);transition:transform .15s ease, background .2s ease
    }
    .chip[data-active="true"]{background:rgba(210,178,109,.18);border-color:rgba(210,178,109,.4)}
    .chip:hover{transform:translateY(-1px);background:rgba(255,255,255,.09)}
    .range{appearance:none;width:180px;height:6px;border-radius:999px;background:rgba(255,255,255,.1);outline:none}
    .range::-webkit-slider-thumb{appearance:none;width:18px;height:18px;border-radius:50%;background:linear-gradient(180deg, #d2b26d, #b2914d);border:2px solid #151515;box-shadow:0 2px 10px rgba(210,178,109,.5)}
    .btn-row{display:flex;gap:10px;margin-top:10px}
    .results{
      display:grid;gap:10px;margin-top:8px;max-height:420px;overflow:auto;padding-right:6px
    }
    .qa{
      background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.09);
      border-radius:14px;padding:12px 12px;display:grid;gap:6px
    }
    .qa .tag{font-family:"Space Mono",monospace;font-size:.75rem;color:var(--gold);opacity:.95;letter-spacing:.06em;text-transform:uppercase}
    .qa .question{font-weight:600}
    .qa .actions{display:flex;gap:8px;flex-wrap:wrap}
    .mini-btn{
      padding:6px 10px;border-radius:999px;border:1px solid rgba(255,255,255,.12);background:rgba(0,0,0,.25);
      color:var(--text);font-size:.85rem;cursor:pointer
    }
    .copy-toast{
      position:fixed;left:50%;transform:translateX(-50%);bottom:26px;z-index:50;
      background:rgba(210,178,109,.95);color:#171717;padding:10px 14px;border-radius:10px;box-shadow:0 10px 30px rgba(0,0,0,.4);opacity:0;pointer-events:none;
      transition:opacity .25s ease, transform .25s ease;
    }
    .copy-toast.show{opacity:1;transform:translateX(-50%) translateY(-6px)}
    /* Reader */
    .reader{
      background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      border:1px solid rgba(255,255,255,.09);border-radius:var(--radius);padding:18px;box-shadow:var(--shadow);
    }
    .essay{
      background:rgba(0,0,0,.28);border:1px solid rgba(255,255,255,.1);border-radius:14px;padding:16px;line-height:1.8;color:var(--muted);
      position:relative;cursor:text
    }
    .selection-bubble{
      position:absolute;z-index:20;background:rgba(24,24,24,.95);border:1px solid rgba(255,255,255,.12);border-radius:12px;box-shadow:var(--shadow);
      padding:10px;display:none;gap:8px
    }
    .selection-bubble .chip{background:rgba(255,255,255,.08)}
    .legend{
      display:flex;flex-wrap:wrap;gap:10px;margin-top:10px;color:var(--dim);font-size:.9rem
    }
    /* Footer */
    footer{
      padding:32px 0;border-top:1px solid rgba(255,255,255,.08);color:var(--dim)
    }
    .foot{
      display:flex;align-items:center;justify-content:space-between;gap:14px;flex-wrap:wrap
    }
    .foot .brand{opacity:.9}
    /* Responsive */
    @media (max-width: 1024px){
      .card{grid-column:span 6}
      .panel{grid-column:span 12}
    }
    @media (max-width: 720px){
      .nav{padding:10px 0}
      .hero-inner{padding:64px 0 48px}
      section{padding:56px 0}
      .cards{grid-template-columns:1fr}
      .card{grid-column:1/-1}
      .engine{grid-template-columns:1fr}
      .panel{grid-column:1/-1}
      .hero-actions{gap:10px}
      .ticker-wrap{padding-bottom:6px}
      .ticker-line{height:24px}
      .brush{opacity:.2}
    }
    /* Reduced motion */
    @media (prefers-reduced-motion: reduce){
      .ticker{animation:none}
      .btn,.btn-primary,.btn-ghost,.chip{transition:none}
    }
  </style>
</head>
<body>
  <header>
    <div class="container nav">
      <div class="brand">
        <div class="brand-mark" aria-hidden="true">
          <svg viewBox="0 0 24 24" fill="none">
            <path d="M4 16.5C7.5 14 11.5 9.5 13.5 6.5M10 19c2.5-2.2 5.8-6.2 8-11" stroke="url(#g1)" stroke-width="2.2" stroke-linecap="round"/>
            <defs>
              <linearGradient id="g1" x1="0" y1="0" x2="24" y2="24">
                <stop offset="0" stop-color="#d2b26d"/><stop offset="1" stop-color="#b2914d"/>
              </linearGradient>
            </defs>
          </svg>
        </div>
        <span>iChatbook</span>
      </div>
      <nav class="nav-links" aria-label="Primary">
        <a href="#how">How it works</a>
        <a href="#socratic">Socratic engine</a>
        <a href="#reader">Reader</a>
      </nav>
      <a class="nav-cta" href="#socratic">Start the Dialogue</a>
    </div>
  </header>

  <main>
    <section class="hero hero-grid-lines" aria-label="Hero">
      <canvas class="ink-canvas" id="inkCanvas"></canvas>

      <svg class="brush" viewBox="0 0 1200 420" aria-hidden="true">
        <defs>
          <filter id="inkify" x="-20%" y="-20%" width="140%" height="140%">
            <feTurbulence type="fractalNoise" baseFrequency="0.9" numOctaves="2" stitchTiles="stitch" result="f1"/>
            <feColorMatrix type="saturate" values="0.2"/>
            <feDisplacementMap in="SourceGraphic" in2="f1" scale="6" xChannelSelector="R" yChannelSelector="G"/>
          </filter>
          <linearGradient id="strokeGrad" x1="0" y1="0" x2="1" y2="0">
            <stop offset="0" stop-color="#c8b07a"/>
            <stop offset="1" stop-color="#68542e"/>
          </linearGradient>
        </defs>
        <path d="M60 260C220 150 370 130 540 200C720 274 860 210 1150 140" stroke="url(#strokeGrad)" stroke-opacity=".65" filter="url(#inkify)" stroke-linecap="round" stroke-linejoin="round" stroke-width="42" fill="none"/>
        <path d="M40 306C260 196 420 180 620 246C820 310 960 250 1180 188" stroke="#c2a563" stroke-opacity=".3" filter="url(#inkify)" stroke-linecap="round" stroke-linejoin="round" stroke-width="16" fill="none"/>
        <path d="M80 320C200 260 360 260 520 300C660 336 820 328 1000 280" stroke="#9a834d" stroke-opacity=".25" filter="url(#inkify)" stroke-linecap="round" stroke-linejoin="round" stroke-width="10" fill="none"/>
      </svg>

      <div class="container hero-inner">
        <span class="eyebrow">Active reading • Socratic method</span>
        <h1 class="hero-title">The End of Passive Reading: Engage, Question, and Challenge Every Idea</h1>
        <p class="hero-sub">iChatbook is a philosophical shift—from consumption to conversation. Build a dialectic with every author: interrogate assumptions, trace arguments, and pressure-test claims until deeper learning emerges.</p>
        <div class="hero-actions">
          <a class="btn btn-primary" href="#socratic">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="M5 12h14M12 5l7 7-7 7" stroke="#111" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
            Start the Dialogue
          </a>
          <a class="btn btn-ghost" href="#how">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none"><circle cx="12" cy="12" r="9" stroke="currentColor" stroke-width="2"/><path d="M9.75 9.5a2.25 2.25 0 1 1 4.5 0c0 1.5-2.25 1.125-2.25 3" stroke="currentColor" stroke-width="2" stroke-linecap="round"/><circle cx="12" cy="16" r="1" fill="currentColor"/></svg>
            How it Works
          </a>
        </div>
      </div>

      <div class="ticker-wrap" aria-hidden="true">
        <div class="ticker-line">
          <div class="ticker" id="ticker1"></div>
        </div>
        <div class="ticker-line">
          <div class="ticker" id="ticker2"></div>
        </div>
        <div class="ticker-line">
          <div class="ticker" id="ticker3"></div>
        </div>
      </div>
    </section>

    <section id="how" aria-label="How it works">
      <div class="container">
        <h2 class="section-title">From Text to Dialogue</h2>
        <p class="section-sub">Every page hides assumptions, leaps, and latent definitions. iChatbook surfaces them. Practice active reading, cultivate critical thinking, and convert claims into questions that sharpen understanding.</p>
        <div class="cards">
          <article class="card">
            <h3>Read Actively</h3>
            <p>Skim less, contend more. Highlight tensions, locate premises, and notice where language smuggles conclusions.</p>
          </article>
          <article class="card">
            <h3>Question Socratically</h3>
            <p>Probe definitions, test implications, and seek falsifiers. Ask what would have to be true—or untrue—for a claim to stand.</p>
          </article>
          <article class="card">
            <h3>Challenge Ideas</h3>
            <p>Steelman and refute. Generate alternatives and counterexamples. Build a dialectic that refines both the author’s position and yours.</p>
          </article>
        </div>
      </div>
    </section>

    <section id="socratic" aria-label="Socratic Engine">
      <div class="container">
        <h2 class="section-title">Socratic Engine</h2>
        <p class="section-sub">Paste a paragraph. Choose your stance. Generate incisive prompts that turn reading into a live debate with the text.</p>
        <div class="engine">
          <div class="panel" id="inputPanel">
            <h4>1. Provide text</h4>
            <textarea class="textarea" id="inputText" placeholder="Paste a paragraph here (e.g., 'Markets are always efficient because prices reflect all available information...')"></textarea>
            <div class="control-row" style="margin-top:14px">
              <span style="color:var(--dim)">Mode:</span>
              <button class="chip" data-mode="socratic" data-active="true">Socratic</button>
              <button class="chip" data-mode="devil">Devil’s Advocate</button>
              <button class="chip" data-mode="steelman">Steelman</button>
            </div>
            <div class="control-row">
              <span style="color:var(--dim)">Intensity:</span>
              <input class="range" id="intensity" type="range" min="1" max="5" value="3" />
              <span id="intensityLabel" style="color:var(--muted);font-weight:600">3</span>
            </div>
            <div class="btn-row">
              <button class="btn btn-primary" id="generateBtn">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="M12 3v18M3 12h18" stroke="#111" stroke-width="2" stroke-linecap="round"/></svg>
                Generate Questions
              </button>
              <button class="btn btn-ghost" id="clearBtn">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="M3 6h18M6 6l1.5 12h9L18 6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
                Clear
              </button>
            </div>
          </div>

          <div class="panel" id="outputPanel">
            <h4>2. Results</h4>
            <div class="results" id="results" aria-live="polite" aria-busy="false"></div>
            <div class="btn-row">
              <button class="btn btn-ghost" id="copyAllBtn">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none"><rect x="9" y="9" width="11" height="11" rx="2" stroke="currentColor" stroke-width="2"/><rect x="4" y="4" width="11" height="11" rx="2" stroke="currentColor" stroke-width="2"/></svg>
                Copy All
              </button>
              <button class="btn btn-ghost" id="shuffleBtn">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="M17 3h4v4M3 7h8a6 6 0 0 1 6 6v8" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
                Shuffle
              </button>
            </div>
          </div>
        </div>
        <div class="legend">
          <span>Keywords: active reading, critical thinking, intellectual engagement, Socratic method, deeper learning, challenge ideas.</span>
        </div>
      </div>
    </section>

    <section id="reader" aria-label="Interactive Reader">
      <div class="container reader">
        <h2 class="section-title">Highlight to Interrogate</h2>
        <p class="section-sub">Select text to surface questions. The goal isn’t agreement—it’s clarity.</p>
        <div class="essay" id="essay">
          <div class="selection-bubble" id="bubble"></div>
          In an age of infinite content, passive reading masquerades as understanding. We confuse familiarity with mastery and volume with depth. But comprehension grows where resistance begins—at the moment we ask what is meant, what is assumed, and what could overturn the claim. The disciplined reader builds a dialectic with the text: they define terms, isolate premises, test implications, and seek potential falsifiers. This is not contrarianism for its own sake; it is intellectual integrity in practice.
        </div>
        <div class="legend">
          <span>Tip: highlight a sentence and pick a prompt. Use the outputs to annotate your reading or guide discussion.</span>
        </div>
      </div>
    </section>
  </main>

  <footer>
    <div class="container foot">
      <div class="brand">
        <div class="brand-mark" aria-hidden="true">
          <svg viewBox="0 0 24 24" fill="none">
            <path d="M4 16.5C7.5 14 11.5 9.5 13.5 6.5M10 19c2.5-2.2 5.8-6.2 8-11" stroke="url(#g1b)" stroke-width="2.2" stroke-linecap="round"/>
            <defs>
              <linearGradient id="g1b" x1="0" y1="0" x2="24" y2="24"><stop offset="0" stop-color="#d2b26d"/><stop offset="1" stop-color="#b2914d"/></linearGradient>
            </defs>
          </svg>
        </div>
        <span>iChatbook</span>
      </div>
      <span>© <span id="year"></span> iChatbook. Read actively. Think rigorously.</span>
    </div>
  </footer>

  <div class="copy-toast" id="toast" role="status" aria-live="polite">Copied to clipboard</div>

  <script>
    // Utility: Toast
    const toast = (msg) => {
      const el = document.getElementById('toast');
      el.textContent = msg || 'Copied to clipboard';
      el.classList.add('show');
      setTimeout(()=>el.classList.remove('show'), 1500);
    };

    // Year
    document.getElementById('year').textContent = new Date().getFullYear();

    // Ticker content generation
    const tickerSymbols = [
      {t:"ASSUMP",name:"Assumption",p:42.11,d:1},
      {t:"EVID",name:"Evidence",p:88.20,d:-1},
      {t:"CLAIM",name:"Claim",p:67.54,d:1},
      {t:"COUNTER",name:"Counterexample",p:23.90,d:-1},
      {t:"DEFINE",name:"Definition",p:51.02,d:1},
      {t:"IMPLY",name:"Implication",p:33.33,d:1},
      {t:"FALSIF",name:"Falsifier",p:14.08,d:1},
      {t:"ALT",name:"Alternative",p:29.76,d:-1},
      {t:"WHY",name:"Why?",p:91.10,d:1},
      {t:"HOW",name:"How?",p:77.77,d:1},
      {t:"WHATIF",name:"What if…",p:19.84,d:-1},
      {t:"STEEL",name:"Steelman",p:58.66,d:1},
      {t:"DEVIL",name:"Devil’s Adv.",p:61.42,d:-1}
    ];
    function buildTickerHTML(offset=0){
      const items = [];
      for (let i=0;i<24;i++){
        const n = (i+offset)%tickerSymbols.length;
        const s = tickerSymbols[n];
        const chg = ((Math.random()*2-1)*2).toFixed(2);
        const cls = (Math.random()>.5) ? 'up' : 'down';
        const arrow = cls==='up'?'▲':'▼';
        const price = (s.p + Math.random()*3 - 1.5).toFixed(2);
        items.push(`<span class="item"><span>${s.t}</span><span class="sep">•</span><span>${price}</span><span class="${cls}" aria-hidden="true">${arrow}${Math.abs(chg)}%</span></span>`);
      }
      // Duplicate to enable seamless loop
      return items.join('') + items.join('');
    }
    function initTickers(){
      const t1 = document.getElementById('ticker1');
      const t2 = document.getElementById('ticker2');
      const t3 = document.getElementById('ticker3');
      t1.innerHTML = buildTickerHTML(0);
      t2.innerHTML = buildTickerHTML(4);
      t3.innerHTML = buildTickerHTML(8);
      // Periodically refresh numbers
      setInterval(()=>{
        t1.innerHTML = buildTickerHTML(Math.floor(Math.random()*10));
        t2.innerHTML = buildTickerHTML(Math.floor(Math.random()*10));
        t3.innerHTML = buildTickerHTML(Math.floor(Math.random()*10));
      }, 9000);
    }

    // Ink canvas background (subtle, performance friendly)
    function initInkCanvas(){
      const canvas = document.getElementById('inkCanvas');
      if(!canvas) return;
      const ctx = canvas.getContext('2d');
      const DPR = Math.min(window.devicePixelRatio || 1, 2);
      function resize(){
        canvas.width = Math.floor(canvas.clientWidth * DPR);
        canvas.height = Math.floor(canvas.clientHeight * DPR);
        draw();
      }
      window.addEventListener('resize', resize, {passive:true});
      const strokes = [];
      function addStroke(){
        const w = canvas.width, h = canvas.height;
        const y = h*(0.35 + Math.random()*0.4);
        const amp = h*(0.02 + Math.random()*0.04);
        const len = w*(0.7 + Math.random()*0.4);
        const x0 = -w*0.2;
        const x1 = x0 + len;
        const thickness = (10 + Math.random()*20)*DPR;
        const roughness = 0.002 + Math.random()*0.004;
        strokes.push({x0,y,x1,amp,thickness,roughness,phase:Math.random()*Math.PI*2, alpha: 0.06 + Math.random()*0.05});
      }
      function draw(){
        const w = canvas.width, h = canvas.height;
        ctx.clearRect(0,0,w,h);
        // background film
        ctx.fillStyle='rgba(255,255,255,0.015)';
        ctx.fillRect(0,0,w,h);
        strokes.forEach((s,i)=>{
          ctx.save();
          ctx.globalAlpha = s.alpha;
          ctx.lineCap='round';
          ctx.lineJoin='round';
          ctx.strokeStyle = i%2? '#c2a563' : '#8a7444';
          ctx.beginPath();
          const steps = 140;
          let prevX = s.x0, prevY = s.y;
          for(let k=0;k<=steps;k++){
            const t = k/steps;
            const x = s.x0 + (s.x1 - s.x0)*t;
            const y = s.y + Math.sin(t*Math.PI + s.phase)*s.amp + (Math.random()-0.5)*s.amp*0.07;
            if(k===0) ctx.moveTo(x,y);
            else ctx.quadraticCurveTo(prevX,prevY,x,y);
            prevX=x; prevY=y;
          }
          ctx.lineWidth = s.thickness;
          ctx.stroke();
          // Dry brush effect overlay
          const grains = 40;
          for(let g=0; g<grains; g++){
            ctx.beginPath();
            ctx.globalAlpha = s.alpha * (0.25+Math.random()*0.35);
            ctx.strokeStyle = i%2? '#d2b26d' : '#9d8652';
            ctx.lineWidth = s.thickness*(0.15+Math.random()*0.25);
            const t0 = Math.random()*0.8;
            const t1 = t0 + 0.1 + Math.random()*0.2;
            const xA = s.x0 + (s.x1 - s.x0)*t0;
            const yA = s.y + Math.sin(t0*Math.PI + s.phase)*s.amp + (Math.random()-0.5)*s.amp*0.1;
            const xB = s.x0 + (s.x1 - s.x0)*t1;
            const yB = s.y + Math.sin(t1*Math.PI + s.phase)*s.amp + (Math.random()-0.5)*s.amp*0.1;
            ctx.moveTo(xA,yA); ctx.lineTo(xB,yB); ctx.stroke();
          }
          ctx.restore();
        });
      }
      // Build strokes
      function rebuild(){
        strokes.length = 0;
        for(let i=0;i<3;i++) addStroke();
        draw();
      }
      resize();
      rebuild();
    }

    // Socratic engine
    const modeButtons = Array.from(document.querySelectorAll('.chip[data-mode]'));
    let currentMode = 'socratic';
    modeButtons.forEach(btn=>{
      btn.addEventListener('click',()=>{
        modeButtons.forEach(b=>b.setAttribute('data-active','false'));
        btn.setAttribute('data-active','true');
        currentMode = btn.getAttribute('data-mode');
      });
    });
    const intensityInput = document.getElementById('intensity');
    const intensityLabel = document.getElementById('intensityLabel');
    intensityInput.addEventListener('input',()=>intensityLabel.textContent = intensityInput.value);

    function sanitize(str){
      return str.replace(/[<>]/g,'').trim();
    }
    function sentenceSplit(text){
      return text
        .replace(/\n+/g,' ')
        .replace(/\s+/g,' ')
        .match(/[^.!?]+[.!?]?/g) || [];
    }
    function extractKeyPhrases(s){
      const words = s.split(/\s+/);
      const picks = [];
      const keywords = ['should','must','because','therefore','implies','leads','always','never','best','proof','shows','evidence','assume','assumption','suggests','likely','inevitable'];
      const tokens = words.map(w=>w.toLowerCase().replace(/[^a-z']/g,''));
      const hasClaim = tokens.some(t=>keywords.includes(t));
      // naive noun-ish picks: capitalized or longer words
      words.forEach(w=>{
        const clean = w.replace(/[^a-zA-Z-']/g,'');
        if((/^[A-Z]/.test(w) && clean.length>2) || clean.length>7) picks.push(clean);
      });
      return {hasClaim, picks: Array.from(new Set(picks)).slice(0,3)};
    }
    function craftQuestions(sentence, mode='socratic', intensity=3){
      const q = [];
      const {hasClaim, picks} = extractKeyPhrases(sentence);
      const target = picks[0] || 'this claim';
      const push = (tag, question)=> q.push({tag, question});
      const sharp = ['gently','directly','pointedly','rigorously','relentlessly'][Math.min(4,Math.max(0,intensity-1))];

      if(mode==='socratic'){
        push('Define', `What precisely do you mean by “${target}”? How is it operationalized here?`);
        push('Assumptions', `What assumptions does this argument rely on, and which are most vulnerable?`);
        push('Evidence', `What evidence specifically supports ${target}? What would count against it?`);
        push('Falsifier', `What observable fact would falsify this? How likely is it?`);
        push('Alternatives', `What alternative explanations compete with this interpretation?`);
        if(hasClaim) push('Implications', `If this holds, what follows ${sharp}, and where does the argument overreach?`);
      } else if(mode==='devil'){
        push('Counterexample', `Name a case where ${target} fails. What does that imply about the general claim?`);
        push('Burden of proof', `Why should we accept this? Where is the burden of proof not met?`);
        push('Causation', `Does correlation masquerade as causation here? What mechanism is specified?`);
        push('Scope', `Where are the boundaries? In which contexts would this be misleading or false?`);
      } else if(mode==='steelman'){
        push('Clarify', `What is the strongest version of this claim? State it as charitably as possible.`);
        push('Best case', `Under which conditions would ${target} be most defensible?`);
        push('Support', `What additional evidence would most strengthen this position?`);
        push('Compare', `Which rival view does this outcompete, and on what criteria?`);
      }

      // Intensify by adding a final probe
      if(intensity>=4){
        push('Why now', `Why should a skeptical reader accept this now, rather than suspend judgment pending stronger reasons?`);
      }
      return q;
    }
    function generate(){
      const text = sanitize(document.getElementById('inputText').value);
      const out = document.getElementById('results');
      out.innerHTML = '';
      if(!text){ out.innerHTML = '<div class="qa"><div class="tag">Hint</div><div class="question">Paste a paragraph to begin.</div></div>'; return; }
      const sentences = sentenceSplit(text).filter(s=>s.trim().length>2).slice(0,6);
      const intensity = parseInt(intensityInput.value,10);
      const allQs = [];
      sentences.forEach((s,idx)=>{
        const qs = craftQuestions(s, currentMode, intensity);
        qs.forEach(({tag,question})=>{
          allQs.push({tag,question,source:s.trim()});
        });
      });
      allQs.slice(0,18).forEach(({tag,question,source},i)=>{
        const el = document.createElement('div');
        el.className='qa';
        el.innerHTML = `
          <div class="tag">${tag}</div>
          <div class="question">${question}</div>
          <div class="actions">
            <button class="mini-btn" data-copy="${encodeURIComponent(question)}">Copy</button>
            <button class="mini-btn" data-insert="${encodeURIComponent(question)}">Append to input</button>
            <span style="color:var(--dim);font-size:.85rem">From: “${source.replace(/"/g,'&quot;')}”</span>
          </div>
        `;
        out.appendChild(el);
      });
    }

    // Actions
    document.getElementById('generateBtn').addEventListener('click', generate);
    document.getElementById('clearBtn').addEventListener('click', ()=>{
      document.getElementById('inputText').value='';
      document.getElementById('results').innerHTML='';
    });
    document.getElementById('copyAllBtn').addEventListener('click', ()=>{
      const qs = Array.from(document.querySelectorAll('#results .question')).map(q=>'- '+q.textContent.trim()).join('\n');
      if(!qs){ toast('Nothing to copy'); return; }
      navigator.clipboard.writeText(qs).then(()=>toast('All questions copied'));
    });
    document.getElementById('shuffleBtn').addEventListener('click', ()=>{
      // a light shuffle: re-generate with different offsets by permuting mode toggles momentarily
      generate();
      toast('Shuffled');
    });
    document.getElementById('results').addEventListener('click',(e)=>{
      const btn = e.target.closest('button');
      if(!btn) return;
      if(btn.dataset.copy){
        const q = decodeURIComponent(btn.dataset.copy);
        navigator.clipboard.writeText(q).then(()=>toast('Question copied'));
      } else if(btn.dataset.insert){
        const q = decodeURIComponent(btn.dataset.insert);
        const t = document.getElementById('inputText');
        t.value = (t.value.trim() + '\n' + q).trim();
        toast('Inserted into input');
      }
    });

    // Selection bubble in the reader
    const essay = document.getElementById('essay');
    const bubble = document.getElementById('bubble');
    function showBubble(x,y, text){
      bubble.innerHTML = '';
      bubble.style.left = (x+8) + 'px';
      bubble.style.top = (y+8) + 'px';
      ['Why?', 'Evidence?', 'What if not?'].forEach(lbl=>{
        const chip = document.createElement('button');
        chip.className='chip';
        chip.textContent = lbl;
        chip.addEventListener('click', ()=>{
          const crafted = {
            'Why?': `Why should we accept: “${text}”?`,
            'Evidence?': `What evidence best supports or undermines: “${text}”?`,
            'What if not?': `If this were false, what else would follow?`
          }[lbl];
          navigator.clipboard.writeText(crafted).then(()=>toast('Prompt copied'));
          bubble.style.display='none';
        });
        bubble.appendChild(chip);
      });
      bubble.style.display='flex';
    }
    essay.addEventListener('mouseup', (e)=>{
      const sel = window.getSelection();
      const s = (sel && sel.toString().trim()) || '';
      if(s.length > 3){
        const rect = essay.getBoundingClientRect();
        const bx = Math.min(e.clientX-rect.left, rect.width-220);
        const by = Math.max(e.clientY-rect.top-50, 10);
        showBubble(bx,by, s.slice(0,280));
      } else {
        bubble.style.display='none';
      }
    });
    document.addEventListener('click', (e)=>{
      if(!bubble.contains(e.target) && e.target!==essay) bubble.style.display='none';
    });

    // Init
    initTickers();
    initInkCanvas();

    // Accessibility: keyboard shortcuts
    document.addEventListener('keydown', (e)=>{
      if(e.key==='Enter' && (e.metaKey||e.ctrlKey)){ generate(); }
    });
  </script>
</body>
</html>
